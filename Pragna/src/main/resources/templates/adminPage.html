<html>
<link
	href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
	rel="stylesheet" id="bootstrap-css">
<script
	src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script
	src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script
	src="https://cdn.jsdelivr.net/npm/sweetalert2@11.3.3/dist/sweetalert2.all.min.js"></script>
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/sweetalert2@11.3.3/dist/sweetalert2.min.css">
<!------ Include the above in your HEAD tag ---------->
<style>
body {
	background-color: #25274d;
}

.contact {
	padding: 4%;
	height: 400px;
}

.col-md-3 {
	background: #f6f92a;
	padding: 4%;
	border-top-left-radius: 0.5rem;
	border-bottom-left-radius: 0.5rem;
}

.contact-info {
	margin-top: 50%;
}

.contact-info img {
	margin-bottom: 15%;
}

.contact-info h2 {
	margin-bottom: 10%;
}

.col-md-9 {
	background: #fff;
	padding: 3%;
	border-top-right-radius: 0.5rem;
	border-bottom-right-radius: 0.5rem;
}

.contact-form label {
	font-weight: 600;
}

.contact-form button {
	background: #25274d;
	color: #fff;
	font-weight: 600;
	width: 25%;
}

.contact-form button:focus {
	box-shadow: none;
}
</style>
<body>

	<div class="container contact">
		<div class="row">
			<div class="col-md-3">
				<div class="contact-info">
					<img src="https://image.ibb.co/kUASdV/contact-image.png"
						alt="image" />
					<h2>ADD PAGE</h2>
					<p style="color: red">Note: Please provide Either Image URL or
						File</p>
				</div>
			</div>
			<div class="col-md-9">
				<div class="contact-form">
					<div class="form-group">
						<!-- <label class="control-label col-sm-2" for="fname">Page Name:</label> -->
						<div class="col-sm-10">
							<input type="text" class="form-control" id="page_name"
								placeholder="Enter Page Name" name="fname">
						</div>
					</div>
					<div class="form-group">
						<!-- <label class="control-label col-sm-2" for="lname">Source:</label> -->
						<div class="col-sm-10">
							<input type="text" class="form-control" id="source_reference"
								placeholder="Enter Source Reference" name="lname">
						</div>
					</div>
					<div class="form-group">
						<!-- <label class="control-label col-sm-2" for="lname">Source:</label> -->
						<div class="col-sm-10">
							<input type="text" class="form-control" id="source"
								placeholder="Enter Source Name" name="lname">
						</div>
					</div>
					<div class="form-group">
						<!-- <label class="control-label col-sm-2" for="email">Image URL:</label> -->
						<div class="col-sm-10">
							<input type="text" class="form-control" id="image_url"
								placeholder="Enter Image URL" name="email">
						</div>
					</div>
					<div class="form-group">
						<!--  <label class="control-label col-sm-2" for="email">Select File:</label> -->
						<div class="col-sm-10">
							<input type="file" class="form-control" id="file">
						</div>
					</div>
					<div class="form-group">
						<!-- <label class="control-label col-sm-2" for="comment">Text:</label> -->
						<div class="col-sm-10">
							<textarea class="form-control" rows="5" id="text"></textarea>
						</div>
					</div>
					<div class="form-group">
						<div class="col-sm-offset-2 col-sm-10">
							<button type="submit" onclick="submitData()"
								class="btn btn-default">Submit</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
<script>
function submitData()
{
	file.onchange = evt => {
		  const [file] = file.files
		  if (file) {
		    blah.src = URL.createObjectURL(file)
		  }
		}
		  
	var singleFileUploadInput = document.querySelector('#file');
	var files = singleFileUploadInput.files;
	if(files.length == 0 && $("#image_url").val() == "")
	{
	Swal.fire(
			  'Invalid Data!',
			  'Please Select File or Provide Image URL!',
			  'warning'
			)
	return;
	}
	if(files.length > 0 && $("#image_url").val() != "")
	{
		Swal.fire(
				  'Provide only one information!',
				  'Please Select File or Provide Image URL only one!',
				  'warning'
				)

	return;
	}
	
	
		  
	var formData = new FormData();
	   formData.append("pageName", $("#page_name").val());
	   formData.append("source", $("#source").val());
	   formData.append("imageUrl", $("#image_url").val());
	   formData.append("sourceReference", $("#source_reference").val());
	   formData.append("text", $("#text").val());
	   formData.append("file", files[0]);
	   
	   var xhr = new XMLHttpRequest();
	   xhr.open("POST", "/page/add_new");
	   xhr.send(formData);
	   xhr.addEventListener("readystatechange", function () {
	   	  if (this.readyState === 4) {
	   		  
	   		Swal.fire({
	   		  title: 'Page Added',
	   		  showClass: {
	   		    popup: 'animate__animated animate__fadeInDown'
	   		  },
	   		  hideClass: {
	   		    popup: 'animate__animated animate__fadeOutUp'
	   		  },
	   		  text: "if you want to see the page, click below",
	   		  icon: 'success',
	   		  showCancelButton: true,
	   		  confirmButtonColor: '#3085d6',
	   		  cancelButtonColor: '#d33',
	   		  confirmButtonText: 'Yes, Want to see it!'
	   		}).then((result) => {
	   		  if (result.isConfirmed) {
	   			 console.log(this.responseText);
	 	   		var response = JSON.parse(this.responseText);
	   		    window.open("/page/"+response, "_self");
	   		  }
	   		})
	   		
	   		
	   		
	   		
	   	  }
	   	}); 
	
}
</script>
</html>